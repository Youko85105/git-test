{"ast":null,"code":"var _jsxFileName = \"/Users/chawsuhan/git-test/sem7-project/project/src/components/PostPage.js\",\n  _s = $RefreshSig$();\n// src/components/PostPage.js\nimport React, { useEffect, useState } from \"react\";\nimport { useLocation, useSearchParams } from \"react-router-dom\";\nimport { usePost } from \"../contexts/PostContext\";\nimport CommentsSection from \"./CommentsSection\";\nimport Navbar from \"./Navbar\";\nimport Footer from \"./Footer\";\nimport PostCard from \"./PostCard\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst PostPage = ({\n  isDarkMode,\n  toggleTheme,\n  isLoggedIn,\n  logout\n}) => {\n  _s();\n  const location = useLocation();\n  const [search] = useSearchParams();\n  const [highlightedCommentId, setHighlightedCommentId] = useState(null);\n  const [author, setAuthor] = useState(null); // ← same pattern as CreatorProfile\n\n  const {\n    post,\n    postId,\n    comments,\n    loading\n  } = usePost();\n\n  // Pick up highlight from state or query (?comment=/ ?highlight=)\n  useEffect(() => {\n    var _location$state;\n    const fromState = ((_location$state = location.state) === null || _location$state === void 0 ? void 0 : _location$state.highlightCommentId) || null;\n    const fromQuery = search.get(\"comment\") || search.get(\"highlight\") || null;\n    setHighlightedCommentId(fromState || fromQuery);\n  }, [location.state, search]);\n\n  // Smooth-scroll to highlighted comment after comments load\n  useEffect(() => {\n    if (!highlightedCommentId || !(comments !== null && comments !== void 0 && comments.length)) return;\n    const el = document.querySelector(`[data-comment-id=\"${highlightedCommentId}\"]`) || document.getElementById(`comment-${highlightedCommentId}`);\n    if (el) {\n      el.scrollIntoView({\n        behavior: \"smooth\",\n        block: \"center\"\n      });\n      el.classList.add(\"ring-2\", \"ring-blue-500\");\n      setTimeout(() => el.classList.remove(\"ring-2\", \"ring-blue-500\"), 1500);\n    }\n  }, [highlightedCommentId, comments]);\n\n  // Load author like CreatorProfile does:\n  // - if the post already has a populated author object, use it\n  // - else, fetch the public creator by id once and store it\n  useEffect(() => {\n    var _objAuthor$profilePic;\n    if (!post) return;\n    const objAuthor = (post.author && typeof post.author === \"object\" ? post.author : null) || (post.creator && typeof post.creator === \"object\" ? post.creator : null);\n    if (objAuthor && (objAuthor !== null && objAuthor !== void 0 && (_objAuthor$profilePic = objAuthor.profilePic) !== null && _objAuthor$profilePic !== void 0 && _objAuthor$profilePic.url || typeof (objAuthor === null || objAuthor === void 0 ? void 0 : objAuthor.profilePic) === \"string\")) {\n      setAuthor(objAuthor);\n      return;\n    }\n    const authorId = (objAuthor === null || objAuthor === void 0 ? void 0 : objAuthor._id) || (objAuthor === null || objAuthor === void 0 ? void 0 : objAuthor.id) || post.authorId || post.creatorId || (typeof post.author === \"string\" ? post.author : null) || (typeof post.creator === \"string\" ? post.creator : null);\n    if (!authorId) {\n      setAuthor(null);\n      return;\n    }\n    fetch(`http://localhost:3002/api/public/creator/${authorId}`).then(r => r.ok ? r.json() : null).then(data => {\n      if (!data) return;\n      setAuthor(data); // { profilePic: { url }, username, handle, _id, ... }\n      console.log(data);\n    }).catch(() => {});\n  }, [post]);\n  if (loading) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"text-center mt-10\",\n    children: \"Loading post...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 77,\n    columnNumber: 23\n  }, this);\n  if (!post) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"text-center mt-10\",\n    children: \"Post not found\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 78,\n    columnNumber: 21\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: `min-h-screen ${isDarkMode ? \"bg-gray-900 text-white\" : \"bg-white text-black\"}`,\n    children: [/*#__PURE__*/_jsxDEV(Navbar, {\n      isDarkMode: isDarkMode,\n      toggleTheme: toggleTheme,\n      isLoggedIn: isLoggedIn,\n      logout: logout\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"max-w-2xl mx-auto py-12 px-4\",\n      children: /*#__PURE__*/_jsxDEV(PostCard, {\n        post: post,\n        author: author // ← same idea as CreatorProfile\n        ,\n        isDarkMode: isDarkMode,\n        onLikeToggle: () => {},\n        highlightId: highlightedCommentId,\n        children: /*#__PURE__*/_jsxDEV(CommentsSection, {\n          postId: postId,\n          title: \"Comments\",\n          highlightId: highlightedCommentId\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Footer, {\n      isDarkMode: isDarkMode\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 81,\n    columnNumber: 5\n  }, this);\n};\n_s(PostPage, \"GP4xtyeOjs4a144+PCIvKQjNJws=\", false, function () {\n  return [useLocation, useSearchParams, usePost];\n});\n_c = PostPage;\nexport default PostPage;\nvar _c;\n$RefreshReg$(_c, \"PostPage\");","map":{"version":3,"names":["React","useEffect","useState","useLocation","useSearchParams","usePost","CommentsSection","Navbar","Footer","PostCard","jsxDEV","_jsxDEV","PostPage","isDarkMode","toggleTheme","isLoggedIn","logout","_s","location","search","highlightedCommentId","setHighlightedCommentId","author","setAuthor","post","postId","comments","loading","_location$state","fromState","state","highlightCommentId","fromQuery","get","length","el","document","querySelector","getElementById","scrollIntoView","behavior","block","classList","add","setTimeout","remove","_objAuthor$profilePic","objAuthor","creator","profilePic","url","authorId","_id","id","creatorId","fetch","then","r","ok","json","data","console","log","catch","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onLikeToggle","highlightId","title","_c","$RefreshReg$"],"sources":["/Users/chawsuhan/git-test/sem7-project/project/src/components/PostPage.js"],"sourcesContent":["// src/components/PostPage.js\nimport React, { useEffect, useState } from \"react\";\nimport { useLocation, useSearchParams } from \"react-router-dom\";\nimport { usePost } from \"../contexts/PostContext\";\nimport CommentsSection from \"./CommentsSection\";\nimport Navbar from \"./Navbar\";\nimport Footer from \"./Footer\";\nimport PostCard from \"./PostCard\";\n\nconst PostPage = ({ isDarkMode, toggleTheme, isLoggedIn, logout }) => {\n  const location = useLocation();\n  const [search] = useSearchParams();\n\n  const [highlightedCommentId, setHighlightedCommentId] = useState(null);\n  const [author, setAuthor] = useState(null); // ← same pattern as CreatorProfile\n\n  const { post, postId, comments, loading } = usePost();\n\n  // Pick up highlight from state or query (?comment=/ ?highlight=)\n  useEffect(() => {\n    const fromState = location.state?.highlightCommentId || null;\n    const fromQuery = search.get(\"comment\") || search.get(\"highlight\") || null;\n    setHighlightedCommentId(fromState || fromQuery);\n  }, [location.state, search]);\n\n  // Smooth-scroll to highlighted comment after comments load\n  useEffect(() => {\n    if (!highlightedCommentId || !comments?.length) return;\n    const el =\n      document.querySelector(`[data-comment-id=\"${highlightedCommentId}\"]`) ||\n      document.getElementById(`comment-${highlightedCommentId}`);\n    if (el) {\n      el.scrollIntoView({ behavior: \"smooth\", block: \"center\" });\n      el.classList.add(\"ring-2\", \"ring-blue-500\");\n      setTimeout(() => el.classList.remove(\"ring-2\", \"ring-blue-500\"), 1500);\n    }\n  }, [highlightedCommentId, comments]);\n\n  // Load author like CreatorProfile does:\n  // - if the post already has a populated author object, use it\n  // - else, fetch the public creator by id once and store it\n  useEffect(() => {\n    if (!post) return;\n\n    const objAuthor =\n      (post.author && typeof post.author === \"object\" ? post.author : null) ||\n      (post.creator && typeof post.creator === \"object\" ? post.creator : null);\n\n    if (objAuthor && (objAuthor?.profilePic?.url || typeof objAuthor?.profilePic === \"string\")) {\n      setAuthor(objAuthor);\n      return;\n    }\n\n    const authorId =\n      objAuthor?._id ||\n      objAuthor?.id ||\n      post.authorId ||\n      post.creatorId ||\n      (typeof post.author === \"string\" ? post.author : null) ||\n      (typeof post.creator === \"string\" ? post.creator : null);\n\n    if (!authorId) {\n      setAuthor(null);\n      return;\n    }\n\n    fetch(`http://localhost:3002/api/public/creator/${authorId}`)\n      .then((r) => (r.ok ? r.json() : null))\n      .then((data) => {\n        if (!data) return;\n        setAuthor(data); // { profilePic: { url }, username, handle, _id, ... }\n        console.log(data);\n      })\n      .catch(() => {});\n  }, [post]);\n\n  if (loading) return <div className=\"text-center mt-10\">Loading post...</div>;\n  if (!post) return <div className=\"text-center mt-10\">Post not found</div>;\n\n  return (\n    <div className={`min-h-screen ${isDarkMode ? \"bg-gray-900 text-white\" : \"bg-white text-black\"}`}>\n      <Navbar isDarkMode={isDarkMode} toggleTheme={toggleTheme} isLoggedIn={isLoggedIn} logout={logout} />\n      <main className=\"max-w-2xl mx-auto py-12 px-4\">\n        <PostCard\n          post={post}\n          author={author}               // ← same idea as CreatorProfile\n          isDarkMode={isDarkMode}\n          onLikeToggle={() => {}}\n          highlightId={highlightedCommentId}\n        >\n          <CommentsSection postId={postId} title=\"Comments\" highlightId={highlightedCommentId} />\n        </PostCard>\n      </main>\n      <Footer isDarkMode={isDarkMode} />\n    </div>\n  );\n};\n\nexport default PostPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}